{% extends 'base.html' %}
{% load static %}

{% block page_title %}Record Sale{% endblock %}

{% block content %}
<!-- Main Container: Centered and responsive -->
<div class="min-h-screen bg-gray-50 py-10 px-4 sm:px-6 lg:px-8 flex justify-center items-start">
    
    <!-- Sale Form Card -->
    <!-- Added shadow-2xl and rounded corners for a premium feel -->
    <div class="max-w-3xl w-full bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-200">
        
        <!-- Header Section (Uses a clean, dark blue header) -->
        <div class="bg-blue-600 text-white p-6 sm:p-8 flex items-center justify-between">
            <h1 class="text-2xl sm:text-3xl font-extrabold flex items-center">
                <!-- Lucide Icon: Receipt -->
                <i data-lucide="receipt" class="w-6 h-6 sm:w-8 sm:h-8 mr-3"></i>
                {% if sale_id %}
                    <span>Edit Sale Record</span>
                {% else %}
                    <span>Record New Sale</span>
                {% endif %}
            </h1>
            <!-- Added a clear exit button -->
            <a href="{% url 'allsales' %}" class="text-white hover:text-blue-200 transition duration-150" title="Go back to Sales List">
                <i data-lucide="x" class="w-6 h-6"></i>
            </a>
        </div>
        
        <!-- Form Body -->
        <div class="p-6 sm:p-8">
            <form method="post" class="space-y-6">
                {% csrf_token %}
                
                <!-- Global Form Errors Alert -->
                {% if form.errors %}
                <div class="bg-red-50 border-l-4 border-red-400 p-4 rounded-lg">
                    <div class="flex items-center">
                        <i data-lucide="alert-triangle" class="w-5 h-5 text-red-500 mr-3"></i>
                        <p class="text-sm text-red-800 font-medium">
                            Please correct the errors below before submitting.
                        </p>
                    </div>
                </div>
                {% endif %}

                <!-- Form Fields Grid: 2 columns on medium screens, 1 on mobile -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <!-- Product Name -->
                    <div>
                        <label for="{{ form.product_name.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-1">Product Name</label>
                        <!-- Applies Tailwind styling to the Django form field -->
                        {{ form.product_name }}
                        {% if form.product_name.errors %}
                        <p class="text-red-500 text-xs mt-1">{{ form.product_name.errors.0 }}</p>
                        {% endif %}
                    </div>
                    
                    <!-- Tonnage (kg) -->
                    <div>
                        <label for="{{ form.tonnage.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-1">Tonnage (kg)</label>
                        {{ form.tonnage }}
                        {% if form.tonnage.errors %}
                        <p class="text-red-500 text-xs mt-1">{{ form.tonnage.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Amount Paid (UGX) -->
                    <div>
                        <label for="{{ form.amount_paid.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-1">Amount Paid (UGX)</label>
                        {{ form.amount_paid }}
                        {% if form.amount_paid.errors %}
                        <p class="text-red-500 text-xs mt-1">{{ form.amount_paid.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Selling Price (UGX) -->
                    <div>
                        <label for="{{ form.selling_price.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-1">Selling Price (UGX)</label>
                        {{ form.selling_price }}
                        {% if form.selling_price.errors %}
                        <p class="text-red-500 text-xs mt-1">{{ form.selling_price.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Buyer's Name -->
                    <div>
                        <label for="{{ form.buyers_name.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-1">Buyer's Name</label>
                        {{ form.buyers_name }}
                        {% if form.buyers_name.errors %}
                        <p class="text-red-500 text-xs mt-1">{{ form.buyers_name.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Sales Agent -->
                    <div>
                        <label for="{{ form.salesagent_name.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-1">Sales Agent</label>
                        {{ form.salesagent_name }}
                        {% if form.salesagent_name.errors %}
                        <p class="text-red-500 text-xs mt-1">{{ form.salesagent_name.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Branch (Spans two columns) -->
                    <div class="md:col-span-2">
                        <label for="{{ form.branch.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-1">Branch</label>
                        {{ form.branch }}
                        {% if form.branch.errors %}
                        <p class="text-red-500 text-xs mt-1">{{ form.branch.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Is Sold on Cash Switch (Spans two columns) -->
                    <div class="md:col-span-2 pt-2">
                        <div class="flex items-center">
                            <!-- Standard checkbox styling -->
                            {{ form.is_sold_on_cash }}
                            <label class="ml-3 text-sm font-semibold text-gray-700" for="{{ form.is_sold_on_cash.id_for_label }}">Sold on Cash</label>
                        </div>
                        {% if form.is_sold_on_cash.errors %}
                        <p class="text-red-500 text-xs mt-1">{{ form.is_sold_on_cash.errors.0 }}</p>
                        {% endif %}
                    </div>

                </div>

                <!-- Action Buttons: Right-aligned, responsive stack -->
                <div class="flex flex-col sm:flex-row justify-end pt-4 space-y-4 sm:space-y-0 sm:space-x-4 border-t pt-6 border-gray-100">
                    
                    <!-- Cancel Button (Gray) -->
                    <a href="{% url 'allsales' %}" class="w-full sm:w-auto flex items-center justify-center space-x-2 bg-gray-500 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-gray-600 transition duration-150 transform hover:-translate-y-0.5">
                        <i data-lucide="x-circle" class="w-5 h-5"></i>
                        <span>Cancel</span>
                    </a>

                    <!-- Save Button (Blue - Primary Action) -->
                    <button type="submit" class="w-full sm:w-auto flex items-center justify-center space-x-2 bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-150 transform hover:-translate-y-0.5">
                        <i data-lucide="save" class="w-5 h-5"></i>
                        <span>Save Changes</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
