
{% extends 'base.html' %}
{% load static %}

{% block title %}Sales Agent Dashboard{% endblock %}

{% block content %}
<div class="container">
    <h1>Welcome,{{ request.username }} </h1>

    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header" style="background-color:#007bff; color:azure">
                    <i class="fa fa-chart-line"></i> Your Total Sales
                </div>
                <div class="card-body">
                    <h2>UGX {{ total_sales|default:"0" }}</h2>
                    <p class="card-text"><small class="text-muted">Total amount of sales you've made.</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card">
                <div class="card-header"style="background-color:#007bff; color:azure;">
                    <i class="fa fa-cubes"></i> Stock Summary
                </div>
                <div class="card-body">
                    {% if total_stock %}
                        <h2>{{ total_stock }} Units</h2>
                        <p class="card-text"><small class="text-muted">Total quantity of all stock items.</small></p>
                        {% if low_stock_products %}
                            <p class="card-text text-warning">
                                <i class="fa fa-exclamation-triangle"></i>
                                Low Stock:
                                {% for product in low_stock_products %}
                                    {{ product.name_of_produce }} ({{ product.tonnage }}kg){% if not forloop.last %}, {% endif %}
                                {% endfor %}
                            </p>
                        {% else %}
                            <p class="card-text text-success">
                                <i class="fa fa-check-circle"></i>
                                Stock levels are looking good.
                            </p>
                        {% endif %}
                    {% else %}
                        <p class="card-text">No stock information available.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <i class="fa fa-history"></i> Recent Sales
                </div>
                <div class="card-body">
                    {% if recent_sales %}
                        <ul class="list-group list-group-flush">
                            {% for sale in recent_sales %}
                                <li class="list-group-item">
                                    {{ sale.product_name }} - UGX {{ sale.total_sales }}
                                    <small class="text-muted">({{ sale.date_and_time|date:"d M Y, H:i" }})</small>
                                </li>
                            {% empty %}
                                <li class="list-group-item">No recent sales recorded.</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="card-text">No recent sales recorded.</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <i class="fa fa-credit-card"></i> Recent Credit Issued
                </div>
                <div class="card-body">
                    {% if recent_credit %}
                        <ul class="list-group list-group-flush">
                            {% for credit_entry in recent_credit %}
                                <li class="list-group-item">
                                    {{ credit_entry.buyer_name }} - UGX {{ credit_entry.amount_due }} Due
                                    <small class="text-muted">({{ credit_entry.Dispatch_date|date:"d M Y" }})</small>
                                </li>
                            {% empty %}
                                <li class="list-group-item">No recent credit issued.</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="card-text">No recent credit issued.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>{{ request.user.username }}!
{% endblock %}

    


</body>
</html>